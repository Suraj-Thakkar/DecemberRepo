name: Selenium Video Tests
on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Set up JDK 19
        uses: actions/setup-java@v4
        with:
          java-version: '19'
          distribution: 'temurin'
          cache: 'maven'

      - name: Install Xvfb and Dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y xvfb libxi6 libgconf-2-4

      - name: Run Tests with Virtual Display
        run: |
          # xvfb-run starts a virtual monitor (1920x1080)
          # Your Java code will record this virtual screen
          xvfb-run --server-args="-screen 0 1920x1080x24" mvn test

      - name: Upload Screenshots and Videos
        if: always() # Upload even if tests fail
        uses: actions/upload-artifact@v4
        with:
          name: test-execution-reports
          path: |
            screenshots/
            recordings/